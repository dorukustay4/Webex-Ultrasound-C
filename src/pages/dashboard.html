<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultrasound Webex - Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../styles/style.css">
</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="16" cy="16" r="16" fill="url(#gradient)"/>
            <path d="M12 10L20 16L12 22V10Z" fill="white"/>
            <defs>
              <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32" gradientUnits="userSpaceOnUse">
                <stop stop-color="#3b82f6"/>
                <stop offset="1" stop-color="#10b981"/>
              </linearGradient>
            </defs>
          </svg>
          <h1 class="gradient-text">Ultrasound Webex</h1>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <ul class="nav-menu">
          <li class="nav-item active">
            <a href="#" class="nav-link" data-page="home">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 7L10 1L17 7V18C17 18.5523 16.5523 19 16 19H4C3.44772 19 3 18.5523 3 18V7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M8 19V13H12V19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>Home</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-page="profile">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2"/>
                <path d="M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>Profile</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-page="call-room">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2 6a2 2 0 012-2h6l2 2h4a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14 11a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2"/>
              </svg>
              <span>Call Room</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" data-page="library">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 12L11 14L15 10M20 6L9 17L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              <span>Library</span>
            </a>
          </li>
        </ul>
      </nav>
      
      <!-- User Info at Bottom of Sidebar -->
      <div class="sidebar-footer">
        <div class="user-info" id="user-info" style="display: none;">
          <div class="user-avatar" id="user-avatar">
            <img id="user-avatar-img" src="" alt="User Avatar">
          </div>
          <div class="user-details">
            <span class="user-name" id="user-name">User Name</span>
            <span class="user-email" id="user-email">user@example.com</span>
          </div>
          <button class="logout-btn" onclick="logout()" title="Sign Out">
            <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 3H5C3.89543 3 3 3.89543 3 5V15C3 16.1046 3.89543 17 5 17H9M13 7L17 11M17 11L13 15M17 11H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        
        <!-- Guest User Info -->
        <div class="guest-info" id="guest-info">
          <div class="guest-avatar">
            <svg width="32" height="32" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2"/>
              <path d="M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z" stroke="currentColor" stroke-width="2"/>
            </svg>
          </div>
          <div class="guest-details">
            <span class="guest-name">Guest User</span>
            <a href="login.html" class="sign-in-link">Sign In</a>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content Area -->
    <main class="main-dashboard">
      <!-- Home Page Content -->
      <div class="page-content" id="home-page">
        <header class="page-header">
          <h1>Welcome to Ultrasound Webex</h1>
          <p>Your intelligent video consultation and annotation platform</p>
        </header>

        <div class="dashboard-grid">
          <!-- Quick Actions -->
          <section class="dashboard-section">
            <h2>Quick Actions</h2>
            <div class="action-cards">
              <div class="action-card">
                <div class="action-icon start-call">
                  <svg width="24" height="24" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 6a2 2 0 012-2h6l2 2h4a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14 11a4 4 0 11-8 0 4 4 0 018 0z" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <h3>Start Call</h3>
                <p>Begin an instant video consultation</p>
                <button class="action-btn start-btn" onclick="startCall()">Start Now</button>
              </div>

              <div class="action-card">
                <div class="action-icon schedule-call">
                  <svg width="24" height="24" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 2V6M14 2V6M2 10H18M4 4H16C17.1046 4 18 4.89543 18 6V16C18 17.1046 17.1046 18 16 18H4C2.89543 18 2 17.1046 2 16V6C2 4.89543 2.89543 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <h3>Schedule Call</h3>
                <p>Plan a future consultation session</p>
                <button class="action-btn schedule-btn" onclick="scheduleCall()">Schedule</button>
              </div>

              <div class="action-card">
                <div class="action-icon join-call">
                  <svg width="24" height="24" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 8V6C15 3.79086 13.2091 2 11 2H9C6.79086 2 5 3.79086 5 6V8M3 10C3 8.89543 3.89543 8 5 8H15C16.1046 8 17 8.89543 17 10V16C17 17.1046 16.1046 18 15 18H5C3.89543 18 3 17.1046 3 16V10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                </div>
                <h3>Join Call</h3>
                <p>Enter an existing consultation room</p>
                <button class="action-btn join-btn" onclick="joinCall()">Join</button>
              </div>
            </div>
          </section>

          <!-- Upcoming Calls -->
          <section class="dashboard-section">
            <h2>Upcoming Calls</h2>
            <div class="upcoming-calls">
              <div class="call-item">
                <div class="call-time">
                  <span class="time">2:30 PM</span>
                  <span class="date">Today</span>
                </div>
                <div class="call-details">
                  <h4>Dr. Sarah Wilson - Cardiology Consultation</h4>
                  <p>Patient: John Smith • Room: 12345</p>
                </div>
                <button class="call-action-btn" onclick="joinScheduledCall('12345')">Join</button>
              </div>

              <div class="call-item">
                <div class="call-time">
                  <span class="time">10:00 AM</span>
                  <span class="date">Tomorrow</span>
                </div>
                <div class="call-details">
                  <h4>Dr. Michael Chen - Radiology Review</h4>
                  <p>Patient: Emma Davis • Room: 67890</p>
                </div>
                <button class="call-action-btn scheduled" disabled>Scheduled</button>
              </div>

              <div class="call-item">
                <div class="call-time">
                  <span class="time">3:15 PM</span>
                  <span class="date">Tomorrow</span>
                </div>
                <div class="call-details">
                  <h4>Dr. Lisa Anderson - Follow-up</h4>
                  <p>Patient: Robert Johnson • Room: 54321</p>
                </div>
                <button class="call-action-btn scheduled" disabled>Scheduled</button>
              </div>
            </div>
          </section>

          <!-- Recent Activity -->
          <section class="dashboard-section recent-activity">
            <h2>Recent Activity</h2>
            <div class="activity-list">
              <div class="activity-item">
                <div class="activity-icon">
                  <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="activity-details">
                  <p>Consultation completed with Dr. Wilson</p>
                  <span class="activity-time">2 hours ago</span>
                </div>
              </div>

              <div class="activity-item">
                <div class="activity-icon">
                  <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 6V4C12 2.89543 11.1046 2 10 2H4C2.89543 2 2 2.89543 2 4V16C2 17.1046 2.89543 18 4 18H16C17.1046 18 18 17.1046 18 16V8C18 6.89543 17.1046 6 16 6H12Z" stroke="currentColor" stroke-width="2"/>
                  </svg>
                </div>
                <div class="activity-details">
                  <p>New annotation saved to library</p>
                  <span class="activity-time">4 hours ago</span>
                </div>
              </div>

              <div class="activity-item">
                <div class="activity-icon">
                  <svg width="16" height="16" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 12L10 14L16 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </div>
                <div class="activity-details">
                  <p>Meeting scheduled for tomorrow</p>
                  <span class="activity-time">1 day ago</span>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>

      <!-- Profile Page Content -->
      <div class="page-content" id="profile-page" style="display: none;">
        <header class="page-header">
          <h1>Profile Settings</h1>
          <p>Manage your account and preferences</p>
        </header>
        <div class="profile-content">
          <p>Profile settings will be implemented here.</p>
        </div>
      </div>

      <!-- Call Room Page Content -->
      <div class="page-content" id="call-room-page" style="display: none;">
        <header class="page-header">
          <h1>Call Room</h1>
          <p>Video consultation and annotation workspace</p>
        </header>
        
        <div class="video-grid">
          <!-- Remote Doctor Webcam -->
          <div class="video-cell">
            <h3>Remote Doctor</h3>
            <video id="remote-doctor-video" autoplay playsinline></video>
          </div>
          <!-- Local Doctor + Patient Webcam -->
          <div class="video-cell">
            <h3>Local Doctor & Patient</h3>
            <video id="local-doctor-video" autoplay playsinline muted></video>
          </div>
          <!-- Live HDMI Feed -->
          <div class="video-cell">
            <h3>Live HDMI Feed</h3>
            <video id="hdmi-feed-video" autoplay playsinline muted></video>
            <button id="screenshot-btn" onclick="takeScreenshot()">Take Screenshot</button>
          </div>
          <!-- Annotation Area with VIA -->
          <div class="video-cell">
            <h3>Image Annotation</h3>
            <div id="via-annotation-area" class="via-container">
              <div class="via-toolbar">
                <button class="via-tool-btn" id="via-rect-tool" onclick="setAnnotationTool('rect')">Rectangle</button>
                <button class="via-tool-btn" id="via-circle-tool" onclick="setAnnotationTool('circle')">Circle</button>
                <button class="via-tool-btn" id="via-polygon-tool" onclick="setAnnotationTool('polygon')">Polygon</button>
                <button class="via-tool-btn" id="via-point-tool" onclick="setAnnotationTool('point')">Point</button>
                <button class="via-tool-btn" id="via-clear-tool" onclick="clearAnnotations()">Clear</button>
                <button class="via-tool-btn" id="via-save-tool" onclick="saveAnnotations()">Save</button>
                <button class="via-tool-btn" id="via-load-tool" onclick="loadImage()">Load Image</button>
              </div>
              <div class="via-canvas-container">
                <canvas id="via-canvas" class="via-canvas"></canvas>
                <div class="via-annotation-list" id="annotation-list">
                  <div style="font-weight: bold; margin-bottom: 5px;">Annotations:</div>
                </div>
              </div>
            </div>
            <img id="screenshot-image" style="display:none; max-width:100%; margin-top:10px;" />
          </div>
        </div>
      </div>

      <!-- Library Page Content -->
      <div class="page-content" id="library-page" style="display: none;">
        <header class="page-header">
          <h1>Annotation Library</h1>
          <p>Browse and manage your saved annotations</p>
        </header>
        <div class="library-content">
          <p>Annotation library will be implemented here.</p>
        </div>
      </div>
    </main>
  </div>

  <script src="../scripts/auth.js"></script>
  <script src="../scripts/dashboard.js"></script>
</body>
</html>
